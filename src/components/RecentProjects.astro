---
import type { CollectionEntry } from "astro:content"
import { getCollection } from "astro:content"
import ProjectListItem from "./ProjectListItem.astro"

const allProjects = (await getCollection(
  "projects",
)) as CollectionEntry<"projects">[]

interface Props {
  limit?: number
}

const { limit = 3 } = Astro.props
---

<div class="my-12">
  <h2 class="text-2xl mb-4 mt-2">Currently Building</h2>

  <ul class="flex flex-col gap-2">
    {
      allProjects
        .filter((project) => project.data.published)
        .sort(
          (a, b) =>
            new Date(b.data.startDate).getTime() -
            new Date(a.data.startDate).getTime(),
        )
        .slice(0, limit)
        .map((project) => <ProjectListItem project={project} />)
    }
  </ul>

  <a
    class="mt-2 flex h-6 rounded-lg leading-7 text-gray-600 transition-all dark:text-gray-400 dark:hover:text-gray-600"
    href="/projects/"
  >
    See all projects â†’
  </a>
</div>
